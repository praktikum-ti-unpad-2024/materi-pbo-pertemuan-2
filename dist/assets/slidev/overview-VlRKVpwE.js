import{_ as J,a as Y}from"../modules/unplugin-icons-PFMis6Oz.js";import{d as j,ae as Z,r as H,af as ee,K as L,E as te,a7 as le,ag as ne,b as k,ah as oe,T as a,o,k as I,n as F,ai as ie,f as x,l as se,p as q,P as ae,z as K,Q as ce,L as re,g as s,F as P,aj as R,i as T,t as w,w as E,e as M}from"../modules/vue-a-ZG5QjA.js";import{u as ue,s as de,a as me,i as pe,b as B,t as fe,g as O,c as ve,C as U,p as he}from"../index-B7NdEJpk.js";import{C as ge}from"./ClicksSlider-cAUPnERr.js";import{_ as ke}from"./DrawingPreview.vue_vue_type_script_setup_true_lang-DWneaJ0F.js";import{_ as A}from"./IconButton.vue_vue_type_script_setup_true_lang-Cot17q3W.js";import{u as _e,S as be}from"./SlideContainer-DZgB5B5r.js";import{_ as xe}from"./NoteDisplay.vue_vue_type_style_index_0_lang-B24_gdsA.js";import{S as ye}from"./SlideWrapper-D9Kw6Vtd.js";import"../modules/shiki-BSV5HcrO.js";const we=["placeholder"],Ce=j({__name:"NoteEditable",props:{no:{type:Number,required:!0},class:{default:""},editing:{default:!1},style:{default:()=>({})},placeholder:{default:"No notes for this slide"},clicksContext:{type:Object},highlight:{default:!0},autoHeight:{default:!1}},emits:["update:editing","markerDblclick","markerClick"],setup(C,{emit:z}){const n=C,y=z,c=ne(n,"editing",y,{passive:!0}),{info:h,update:D}=_e(Z(n,"no")),m=H("");let S;const{ignoreUpdates:_}=ee(m,p=>{if(!c.value)return;const u=n.no;clearTimeout(S),S=setTimeout(()=>{D({note:p},u)},500)});L(()=>h.value?.note,(p="")=>{c.value||(clearTimeout(S),_(()=>{m.value=p}))},{immediate:!0,flush:"sync"});const r=H(),b=H();te(()=>{c.value&&r.value?.focus()}),le(r,()=>{c.value=!1});function N(){!n.autoHeight||!r.value||!c.value||r.value.scrollHeight>r.value.clientHeight&&(r.value.style.height=`${r.value.scrollHeight}px`)}function V(p){c.value&&p.metaKey&&p.key==="s"&&(p.preventDefault(),D({note:m.value},n.no))}return L([m,c],()=>{q(()=>{N()})},{flush:"post",immediate:!0}),(p,u)=>a(c)?oe((o(),x("textarea",{key:1,ref_key:"inputEl",ref:r,"onUpdate:modelValue":u[2]||(u[2]=g=>m.value=g),class:F(["prose resize-none overflow-auto outline-none bg-transparent block border-primary border-2",n.class]),style:I([{"line-height":"1.75"},[n.style,b.value!=null?{height:`${b.value}px`}:{}]]),placeholder:C.placeholder,onKeydown:[u[3]||(u[3]=se(g=>c.value=!1,["esc"])),V]},null,46,we)),[[ie,m.value]]):(o(),k(xe,{key:0,class:F(["border-transparent border-2",[n.class,m.value?"":"opacity-25 italic select-none"]]),style:I(n.style),note:m.value||C.placeholder,"note-html":a(h)?.noteHTML,"clicks-context":C.clicksContext,"auto-scroll":!C.autoHeight,highlight:n.highlight,onMarkerClick:u[0]||(u[0]=(g,$)=>y("markerClick",g,$)),onMarkerDblclick:u[1]||(u[1]=(g,$)=>y("markerDblclick",g,$))},null,8,["class","style","note","note-html","clicks-context","auto-scroll","highlight"]))}}),De={class:"h-screen w-screen of-hidden flex"},$e={class:"grid grid-rows-[auto_max-content] border-r border-main select-none max-h-full h-full"},Fe={class:"relative"},Se={class:"absolute left-0 top-0 bottom-0 w-200 flex flex-col flex-auto items-end group p2 gap-1 max-h-full of-x-visible of-y-auto",style:{direction:"rtl"}},Ee=["onClick"],Me={p2:"",border:"t main"},He={class:"select-none w-13 text-right my4 flex flex-col gap-1 items-end"},Ne={class:"text-3xl op20 mb2"},Te=s("div",{class:"i-carbon:presentation-file"},null,-1),Be=["onDblclick"],Ae={class:"py3 mt-0.5 mr--8 ml--4 op0 transition group-hover:op100"},Ie=s("div",{class:"i-carbon:pen"},null,-1),Ve={key:0,class:"select-none absolute bottom-0 right-0 bg-main rounded-tl p2 op35 text-xs"},Ke={class:"absolute top-0 right-0 px3 py1.5 border-b border-l rounded-lb bg-main border-main select-none"},We={class:"text-xs op50"},W=450,Ge=j({__name:"overview",setup(C){ue({title:`Overview - ${de}`});const{openInEditor:z,slides:n}=me(),y=ae(new Map),c=H([]),h=H(null),D=K(()=>n.value.map(e=>p(e.meta?.slide?.note||""))),m=K(()=>D.value.reduce((e,l)=>e+l,0)),S=K(()=>n.value.map(e=>N(e)).reduce((e,l)=>e+l,0)),_=ce(),r=new WeakMap;function b(e){return r.has(e)||r.set(e,ve(e,U)),r.get(e)}function N(e){return e.meta?.clicks||b(e)?.total}function V(e){_.value===e?_.value=void 0:_.value=e}function p(e){const l=/[\w`'\-\u0392-\u03C9\u00C0-\u00FF\u0600-\u06FF\u0400-\u04FF]+|[\u4E00-\u9FFF\u3400-\u4DBF\uF900-\uFAFF\u3040-\u309F\uAC00-\uD7AF]+/g,i=e.match(l);let f=0;if(!i)return 0;for(let t=0;t<i.length;t++)i[t].charCodeAt(0)>=19968?f+=i[t].length:f+=1;return f}function u(e){const l=e.getBoundingClientRect(),i=20;return l.top>=0-i&&l.left>=0-i&&l.bottom<=(window.innerHeight||document.documentElement.clientHeight)+i&&l.right<=(window.innerWidth||document.documentElement.clientWidth)+i}function g(){const e=[];Array.from(y.entries()).forEach(([l,i])=>{u(i)&&e.push(l)}),c.value=e}function $(e){const l=document.createElement("a");l.target="_blank",l.href=he+e.slice(1),l.click()}function Q(e){const l=y.get(e);l&&l.scrollIntoView({behavior:"smooth",block:"start"})}function X(e,l,i){const f=b(i);f.current===l?f.current=U:f.current=l,e.preventDefault()}return re(()=>{q(()=>{g()})}),(e,l)=>{const i=J,f=Y;return o(),x("div",De,[s("nav",$e,[s("div",Fe,[s("div",Se,[(o(!0),x(P,null,R(a(n),(t,v)=>(o(),x("div",{key:t.no,class:"relative",style:{direction:"ltr"}},[s("button",{class:F(["relative transition duration-300 w-8 h-8 rounded hover:bg-active hover:op100",c.value.includes(v)?"op100 text-primary bg-gray:5":"op20"]),onClick:d=>Q(v)},[s("div",null,w(v+1),1)],10,Ee),t.meta?.slide?.title?(o(),x("div",{key:0,class:F(["pointer-events-none select-none absolute left-110% top-50% translate-y--50% ws-nowrap z-label px2 slidev-glass-effect transition duration-400 op0 group-hover:op100",c.value.includes(v)?"text-primary":"text-main important-text-op-50"])},w(t.meta?.slide?.title),3)):T("",!0)]))),128))])]),s("div",Me,[a(pe)?(o(),k(A,{key:1,title:a(B)?"Dark mode":"Light mode","pointer-events-none":"",op50:""},{default:E(()=>[a(B)?(o(),k(i,{key:0})):(o(),k(f,{key:1}))]),_:1},8,["title"])):(o(),k(A,{key:0,title:a(B)?"Switch to light mode theme":"Switch to dark mode theme",onClick:l[0]||(l[0]=t=>a(fe)())},{default:E(()=>[a(B)?(o(),k(i,{key:0})):(o(),k(f,{key:1}))]),_:1},8,["title"]))])]),s("main",{class:"flex-1 h-full of-auto",style:I(`grid-template-columns: repeat(auto-fit,minmax(${W}px,1fr))`),onScroll:g},[(o(!0),x(P,null,R(a(n),(t,v)=>(o(),x("div",{key:t.no,ref_for:!0,ref:d=>y.set(v,d),class:F(["relative border-t border-main of-hidden flex gap-4 min-h-50 group",v===0?"pt5":""])},[s("div",He,[s("div",Ne,w(v+1),1),M(A,{class:"mr--3 op0 group-hover:op80",title:"Play in new tab",onClick:d=>$(a(O)(t,!1))},{default:E(()=>[Te]),_:2},1032,["onClick"]),T("",!0)]),s("div",{class:"flex flex-col gap-2 my5",style:I({width:`${W}px`})},[s("div",{class:"border rounded border-main overflow-hidden bg-main select-none h-max",onDblclick:d=>$(a(O)(t,!1))},[(o(),k(be,{key:t.no,width:W,class:"pointer-events-none important:[&_*]:select-none"},{default:E(()=>[M(ye,{"clicks-context":b(t),route:t,"render-context":"overview"},null,8,["clicks-context","route"]),M(ke,{page:t.no},null,8,["page"])]),_:2},1024))],40,Be),N(t)?(o(),k(ge,{key:0,active:_.value===t,"clicks-context":b(t),class:"w-full mt-2",onDblclick:d=>V(t),onClick:d=>_.value=t},null,8,["active","clicks-context","onDblclick","onClick"])):T("",!0)],4),s("div",Ae,[M(A,{title:"Edit Note",class:F(["rounded-full w-9 h-9 text-sm",h.value===t.no?"important:op0":""]),onClick:d=>h.value=t.no},{default:E(()=>[Ie]),_:2},1032,["class","onClick"])]),M(Ce,{no:t.no,class:"max-w-250 w-250 text-lg rounded p3","auto-height":!0,highlight:_.value===t,editing:h.value===t.no,"clicks-context":b(t),onDblclick:d=>h.value!==t.no?h.value=t.no:null,"onUpdate:editing":l[1]||(l[1]=d=>h.value=null),onMarkerClick:(d,G)=>X(d,G,t)},null,8,["no","highlight","editing","clicks-context","onDblclick","onMarkerClick"]),D.value[v]>0?(o(),x("div",Ve,w(D.value[v])+" words ",1)):T("",!0)],2))),128))],36),s("div",Ke,[s("div",We,w(a(n).length)+" slides · "+w(S.value+a(n).length-1)+" clicks · "+w(m.value)+" words ",1)])])}}});export{Ge as default};
